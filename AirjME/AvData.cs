using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml;
using Process.NET.Native.Types;

namespace AirjME
{
    public class AvData
    {
        private static Position[] mainPositionList =
        {
            new Position(873.0018f, -491.28363f),
            new Position(865.0398f, -497.34717f),
            new Position(855.0652f, -499.0001f),
            new Position(844.9272f, -498.38226f),
            new Position(834.7775f, -497.45435f),
            new Position(824.6471f, -496.33594f),
            new Position(814.49567f, -495.2533f),
            new Position(804.3818f, -494.1769f),
            new Position(794.3194f, -493.4442f),
            new Position(784.15076f, -492.57178f),
            new Position(773.99054f, -491.7675f),
            new Position(763.6663f, -490.17868f),
            new Position(753.5942f, -486.86157f),
            new Position(743.8562f, -483.0128f),
            new Position(734.369f, -478.63104f),
            new Position(725.30054f, -473.17456f),
            new Position(716.96124f, -466.93674f),
            new Position(709.53235f, -459.5486f),
            new Position(702.7551f, -451.49774f),
            new Position(696.34393f, -443.0999f),
            new Position(690.31226f, -434.51782f),
            new Position(684.2596f, -426.001f),
            new Position(676.64624f, -419.51587f),
            new Position(668.4058f, -413.072f),
            new Position(660.0567f, -406.7515f),
            new Position(651.61523f, -400.51657f),
            new Position(643.13104f, -394.2501f),
            new Position(633.529f, -390.07098f),
            new Position(623.3912f, -387.65463f),
            new Position(612.9176f, -388.6456f),
            new Position(602.59393f, -390.44046f),
            new Position(592.46716f, -393.0178f),
            new Position(582.0836f, -394.92822f),
            new Position(571.7661f, -396.83673f),
            new Position(561.5469f, -399.17374f),
            new Position(551.35626f, -401.53583f),
            new Position(541.12195f, -403.90802f),
            new Position(530.93134f, -406.2701f),
            new Position(520.6971f, -408.6423f),
            new Position(510.43005f, -411.0221f),
            new Position(500.10022f, -412.11398f),
            new Position(489.6121f, -411.21918f),
            new Position(479.1682f, -410.19055f),
            new Position(468.79123f, -409.16855f),
            new Position(458.2805f, -408.13336f),
            new Position(447.84775f, -407.10583f),
            new Position(437.4596f, -406.08273f),
            new Position(426.96002f, -405.0486f),
            new Position(416.5913f, -403.7409f),
            new Position(406.3229f, -401.41742f),
            new Position(396.01855f, -399.4326f),
            new Position(385.6986f, -397.5897f),
            new Position(375.36667f, -395.74466f),
            new Position(365.05743f, -393.90543f),
            new Position(354.64752f, -392.3764f),
            new Position(344.26855f, -391.07373f),
            new Position(333.85324f, -389.88248f),
            new Position(323.33878f, -389.37582f),
            new Position(312.89557f, -390.10287f),
            new Position(302.59766f, -391.72964f),
            new Position(291.10736f, -391.13403f),
            new Position(280.78128f, -393.3195f),
            new Position(270.72632f, -396.29486f),
            new Position(261.1042f, -400.42902f),
            new Position(253.19092f, -406.57938f),
            new Position(243.56197f, -410.22928f),
            new Position(233.00777f, -410.58246f),
            new Position(222.9536f, -407.92773f),
            new Position(200.27397f, -406.6731f),
            new Position(191.18358f, -402.23425f),
            new Position(182.18047f, -397.74005f),
            new Position(173.99466f, -391.9661f),
            new Position(166.28276f, -385.48868f),
            new Position(159.22282f, -378.1325f),
            new Position(152.35486f, -370.8637f),
            new Position(146.03273f, -363.07248f),
            new Position(140.53789f, -354.5697f),
            new Position(135.07628f, -346.11838f),
            new Position(129.6192f, -337.67407f),
            new Position(124.04774f, -329.34836f),
            new Position(118.37075f, -321.072f),
            new Position(112.64922f, -312.73068f),
            new Position(106.9574f, -304.43268f),
            new Position(101.270515f, -296.14188f),
            new Position(95.57374f, -287.83667f),
            new Position(89.44923f, -279.88748f),
            new Position(81.18954f, -274.0087f),
            new Position(72.09214f, -269.33273f),
            new Position(63.119255f, -264.72076f),
            new Position(54.154152f, -260.11276f),
            new Position(45.212402f, -255.5168f),
            new Position(36.278427f, -250.92484f),
            new Position(27.313328f, -246.31686f),
            new Position(18.363792f, -241.71689f),
            new Position(9.263699f, -237.50554f),
            new Position(-0.34327015f, -234.46352f),
            new Position(-9.84856f, -231.2769f),
            new Position(-19.299921f, -227.93f),
            new Position(-28.442173f, -223.81316f),
            new Position(-37.606487f, -219.27061f),
            new Position(-45.43222f, -212.62964f),
            new Position(-52.40843f, -205.44121f),
            new Position(-59.339405f, -198.18257f),
            new Position(-66.10544f, -190.74837f),
            new Position(-72.96935f, -183.427f),
            new Position(-79.91396f, -176.1089f),
            new Position(-87.35777f, -169.28539f),
            new Position(-95.11588f, -162.8724f),
            new Position(-102.90538f, -156.43347f),
            new Position(-110.65442f, -150.02798f),
            new Position(-118.400276f, -143.62512f),
            new Position(-126.17709f, -137.19666f),
            new Position(-133.95985f, -130.76329f),
            new Position(-138.19017f, -117.998856f),
            new Position(-142.09918f, -108.272156f),
            new Position(-146.76796f, -98.88836f),
            new Position(-152.4621f, -90.124054f),
            new Position(-160.60468f, -83.53245f),
            new Position(-169.04228f, -77.2547f),
            new Position(-177.60301f, -71.27686f),
            new Position(-186.42537f, -65.536606f),
            new Position(-195.69029f, -60.681244f),
            new Position(-205.25267f, -56.47076f),
            new Position(-215.00275f, -52.530342f),
            new Position(-224.94644f, -49.107235f),
            new Position(-234.87405f, -45.756577f),
            new Position(-245.11768f, -43.87932f),
            new Position(-255.55353f, -44.108654f),
            new Position(-266.04077f, -44.319176f),
            new Position(-276.54425f, -44.530025f),
            new Position(-287.04773f, -44.740875f),
            new Position(-297.56772f, -44.95206f),
            new Position(-308.0264f, -45.16201f),
            new Position(-318.48312f, -46.101532f),
            new Position(-328.901f, -47.484203f),
            new Position(-339.2589f, -49.171104f),
            new Position(-348.75104f, -52.90736f),
            new Position(-359.11548f, -54.67623f),
            new Position(-369.24048f, -56.894577f),
            new Position(-378.17926f, -62.304462f),
            new Position(-386.7718f, -68.349f),
            new Position(-395.21323f, -74.591156f),
            new Position(-402.3361f, -82.249054f),
            new Position(-407.29507f, -91.448906f),
            new Position(-411.10623f, -101.26274f),
            new Position(-414.45575f, -111.207275f),
            new Position(-416.6166f, -121.442116f),
            new Position(-418.79236f, -131.76573f),
            new Position(-420.24924f, -142.12314f),
            new Position(-421.58252f, -152.54376f),
            new Position(-422.8851f, -162.8893f),
            new Position(-424.15836f, -173.33192f),
            new Position(-425.42783f, -183.744f),
            new Position(-427.8057f, -193.83945f),
            new Position(-436.451f, -224.59384f),
            new Position(-434.6023f, -234.88802f),
            new Position(-437.33908f, -244.95343f),
            new Position(-441.8312f, -254.3906f),
            new Position(-447.84644f, -262.9755f),
            new Position(-455.98184f, -269.41003f),
            new Position(-465.32227f, -274.26758f),
            new Position(-474.5732f, -279.07864f),
            new Position(-483.86523f, -283.911f),
            new Position(-492.8103f, -289.40732f),
            new Position(-498.6487f, -298.08124f),
            new Position(-503.88275f, -307.1841f),
            new Position(-509.1457f, -316.25555f),
            new Position(-514.6305f, -325.13684f),
            new Position(-520.50464f, -333.46564f),
            new Position(-530.79474f, -335.36664f),
            new Position(-540.7774f, -332.1197f),
            new Position(-550.5059f, -328.27454f),
            new Position(-560.3553f, -324.7221f),
            new Position(-569.8184f, -320.10858f),
            new Position(-579.8781f, -318.07968f),
            new Position(-590.3356f, -319.1726f),
            new Position(-598.76086f, -325.25436f),
            new Position(-605.3507f, -333.36844f),
            new Position(-610.2889f, -342.67908f),
            new Position(-615.45917f, -351.8004f),
            new Position(-620.0163f, -361.18924f),
            new Position(-621.65735f, -371.5631f),
            new Position(-621.3017f, -382.00757f),
            new Position(-617.0963f, -391.60205f),
            new Position(-614.49493f, -401.35147f),
            new Position(-624.16864f, -405.31683f),
            new Position(-633.0616f, -400.24368f),
            new Position(-641.84906f, -394.54797f),
            new Position(-650.9081f, -389.43246f),
            new Position(-660.2243f, -384.50473f),
            new Position(-669.4624f, -379.6183f),
            new Position(-678.8977f, -375.0381f),
            new Position(-688.4577f, -370.77145f),
            new Position(-698.0819f, -366.47617f),
            new Position(-707.6652f, -362.19916f),
            new Position(-716.3112f, -356.4761f),
            new Position(-723.63904f, -348.90186f),
            new Position(-732.97675f, -344.3211f),
            new Position(-746.7832f, -340.61676f),
            new Position(-756.1839f, -335.73352f),
            new Position(-766.0907f, -334.19183f),
            new Position(-776.3311f, -335.51f),
            new Position(-786.3233f, -337.74008f),
            new Position(-796.3171f, -337.1742f),
            new Position(-806.4215f, -334.19144f),
            new Position(-816.28455f, -330.6066f),
            new Position(-826.1445f, -327.013f),
            new Position(-835.9834f, -323.42706f),
            new Position(-845.8616f, -319.84232f),
            new Position(-856.2795f, -319.37338f),
            new Position(-864.9391f, -314.05063f),
            new Position(-875.0387f, -311.6698f),
            new Position(-885.36334f, -309.55563f),
            new Position(-895.761f, -308.23108f),
            new Position(-906.01776f, -306.34247f),
            new Position(-916.43225f, -305.17908f),
            new Position(-926.56323f, -307.7788f),
            new Position(-936.66315f, -310.67014f),
            new Position(-945.7645f, -315.3816f),
            new Position(-953.8922f, -321.47437f),
            new Position(-962.4067f, -326.9279f),
            new Position(-971.5101f, -331.20395f),
            new Position(-981.1297f, -334.0046f),
            new Position(-991.27106f, -334.68265f),
            new Position(-1001.45435f, -335.3635f),
            new Position(-1011.6217f, -334.7763f),
            new Position(-1021.66675f, -333.22574f),
            new Position(-1031.7585f, -331.75867f),
            new Position(-1041.9932f, -331.4012f),
            new Position(-1052.1375f, -332.1241f),
            new Position(-1062.3849f, -332.89014f),
            new Position(-1072.5236f, -333.648f),
            new Position(-1082.6383f, -335.25333f),
            new Position(-1097.0508f, -337.6078f),
            new Position(-1107.4834f, -338.63605f),
            new Position(-1117.5042f, -338.41904f),
            new Position(-1127.5248f, -341.45636f),
            new Position(-1136.4861f, -347.03705f),
            new Position(-1146.2638f, -350.6074f),
            new Position(-1156.6631f, -352.31522f),
            new Position(-1165.8655f, -352.45816f),
            new Position(-1175.8766f, -351.78146f),
            new Position(-1183.9308f, -345.7725f),
            new Position(-1192.3999f, -340.1508f),
            new Position(-1202.1129f, -337.7137f),
            new Position(-1212.1497f, -337.25018f),
            new Position(-1218.212f, -329.16534f),
            new Position(-1220.6989f, -319.42883f),
            new Position(-1220.4257f, -309.26288f),
            new Position(-1216.7534f, -299.79776f),
            new Position(-1211.2325f, -291.441f),
            new Position(-1208.4341f, -281.8265f),
            new Position(-1207.5703f, -271.81967f),
            new Position(-1202.7345f, -263.038f),
            new Position(-1203.5603f, -253.05154f),
            new Position(-1213.5819f, -252.29411f),
            new Position(-1223.6046f, -251.83858f),
            new Position(-1233.5695f, -250.68257f),
            new Position(-1243.6255f, -250.79277f),
            new Position(-1249.2593f, -259.17725f),
            new Position(-1254.003f, -268.04947f),
            new Position(-1260.1554f, -276.18655f),
            new Position(-1267.5099f, -282.9841f),
            new Position(-1276.6016f, -287.5731f),
            new Position(-1286.5751f, -289.01157f),
            new Position(-1296.528f, -289.99887f),
            new Position(-1306.5399f, -290.5574f),
            new Position(-1316.5734f, -291.03476f),
            new Position(-1326.592f, -291.16516f),
            new Position(-1336.6582f, -290.6773f),
            new Position(-1346.5468f, -293.34503f),
            new Position(-1355.0317f, -298.72327f),
            new Position(-1363.5f, -304.1581f),
            new Position(-1372.3439f, -308.93408f),
            new Position(-1381.4613f, -313.23282f),
            new Position(-1390.5596f, -317.48862f),
            new Position(-1400.3363f, -319.67163f),
            new Position(-1410.5067f, -319.02545f),
            new Position(-1419.4683f, -314.57916f),
            new Position(-1428.0294f, -309.06125f),
            new Position(-1438.0594f, -309.18015f),
            new Position(-1447.716f, -311.79416f),
            new Position(-1457.1322f, -315.29623f),
            new Position(-1466.3872f, -319.13797f),
            new Position(-1475.6566f, -322.98566f),
        };

        private static Position[] lmPositionList =
        {
            new Position(676.0f, -374.0f),
            new Position(670.61414f, -364.96973f),
            new Position(666.41174f, -355.43665f),
            new Position(666.03674f, -344.96017f),
            new Position(665.6606f, -334.44974f),
            new Position(665.3011f, -323.9509f),
            new Position(664.20825f, -313.56403f),
            new Position(660.6939f, -303.7867f),
            new Position(653.90424f, -296.21112f),
            new Position(643.75415f, -295.63626f),
            new Position(636.49255f, -303.06085f),
            new Position(630.13684f, -311.39767f),
            new Position(623.78955f, -319.85324f),
            new Position(617.49426f, -328.20764f),
            new Position(610.20905f, -335.5778f),
            new Position(599.864f, -336.4069f),
            new Position(589.42694f, -335.4249f),
            new Position(578.9917f, -334.1492f),
            new Position(568.5991f, -332.466f),
            new Position(558.1859f, -331.0975f),
            new Position(547.7878f, -329.95413f),
            new Position(537.3451f, -328.80588f),
            new Position(526.902f, -327.65756f),
            new Position(516.8626f, -329.91202f),
            new Position(507.59708f, -334.83038f),
            new Position(498.51654f, -340.1579f),
            new Position(489.52972f, -345.55298f),
            new Position(480.6902f, -351.2093f),
            new Position(471.8541f, -356.8711f),
            new Position(462.98972f, -362.551f),
            new Position(454.1485f, -368.1837f),
            new Position(444.758f, -372.86075f),
            new Position(435.0035f, -376.63937f),
            new Position(425.20798f, -380.4339f),
            new Position(415.3978f, -384.19012f),
            new Position(405.1073f, -386.61017f),
            new Position(394.87573f, -388.94412f),
            new Position(384.6626f, -390.9383f),
            new Position(374.15085f, -390.613f),
            new Position(363.64783f, -390.28754f),
            new Position(353.2297f, -389.26703f),
            new Position(342.8146f, -388.31995f),
            new Position(332.80792f, -387.9705f),
            new Position(322.37592f, -387.79095f),
            new Position(311.93567f, -388.51282f),
            new Position(301.4746f, -389.58923f),
        };

        private static Position[] lmjjPositionList =
        {
            new Position(643.0f, 44.0f),
            new Position(643.0797f, 33.85311f),
            new Position(643.1609f, 23.52703f),
            new Position(643.2416f, 13.256947f),
            new Position(643.1214f, 2.9540339f),
            new Position(643.005f, -7.281485f),
            new Position(643.172f, -17.616785f),
            new Position(643.65314f, -27.8759f),
            new Position(642.09454f, -37.77315f),
            new Position(638.01135f, -47.20917f),
            new Position(634.8029f, -56.988697f),
            new Position(633.892f, -67.194145f),
            new Position(633.1239f, -77.469475f),
            new Position(631.7682f, -87.633835f),
            new Position(629.6953f, -97.738495f),
            new Position(627.3825f, -107.765625f),
            new Position(624.78937f, -117.70327f),
            new Position(622.1934f, -127.65175f),
            new Position(619.6649f, -137.57047f),
            new Position(619.373f, -147.82848f),
            new Position(620.07416f, -158.06326f),
            new Position(620.9154f, -168.3252f),
            new Position(622.23193f, -178.47595f),
            new Position(623.72363f, -188.6714f),
            new Position(625.2056f, -198.80035f),
            new Position(626.913f, -208.90692f),
            new Position(628.73865f, -219.07014f),
            new Position(630.1856f, -229.23811f),
            new Position(631.63574f, -239.42825f),
            new Position(633.07794f, -249.56294f),
            new Position(634.5265f, -259.742f),
            new Position(635.9655f, -269.85452f),
            new Position(637.6345f, -280.0103f),
            new Position(639.85425f, -290.11548f),
        };

        private static Position[] bxPositionList =
        {
            new Position(-531.21783f, -405.23138f),
            new Position(-540.5538f, -401.4396f),
            new Position(-550.5656f, -401.0828f),
            new Position(-560.90485f, -402.87637f),
            new Position(-571.23456f, -404.4709f),
            new Position(-581.59186f, -406.06964f),
            new Position(-591.7021f, -408.19836f),
            new Position(-601.8047f, -410.0664f),
            new Position(-611.2794f, -405.73f),
        };

        private static List<Node> _nodeList = new List<Node>();

        public static List<Node> GetNodeList()
        {
            return _nodeList;
        }

        public static bool IsInBattle(Position position)
        {
            return -2500 < position.x && position.x < 1800 && -1000 < position.y && position.y < 1000;
        }

        public static bool IsInCave(Position position)
        {
            return position.x > 767;
        }

        static AvData()
        {
            Node lastNode = null;
            foreach (var position in mainPositionList)
            {
                var node = new Node(position);
                if (!(lastNode is null))
                {
                    lastNode.ConnectTo.Add(node);
                }

                lastNode = node;
                _nodeList.Add(node);
            }

            var plList = new Position[][]
            {
                lmPositionList, lmjjPositionList, bxPositionList
            };

            foreach (var positionsList in plList)
            {
                lastNode = null;
                foreach (var position in positionsList)
                {
                    var node = new Node(position);
                    if (!(lastNode is null))
                    {
                        lastNode.ConnectTo.Add(node);
                    }

                    lastNode = node;
                    _nodeList.Add(node);
                }

                if (lastNode != null)
                {
                    var minNodeDistance = _nodeList.SkipLast(1).Min(node => lastNode.Position.DistanceTo2d(node.Position));
                    var minNode = _nodeList.SkipLast(1).First(node => Math.Abs(lastNode.Position.DistanceTo2d(node.Position) - minNodeDistance) < 1e-6);
                    lastNode.ConnectTo.Add(minNode);
                }
            }
        }
    }
}